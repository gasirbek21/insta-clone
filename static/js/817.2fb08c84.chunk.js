"use strict";(self.webpackChunkinstagram_app=self.webpackChunkinstagram_app||[]).push([[817],{6817:function(e,t,n){n.r(t),n.d(t,{default:function(){return R}});var s=n(4165),r=n(5861),l=n(9439),o=n(2791),c=n(6871),a=n(6042),i=n(6511),u=n(1413),d=n(6659),x=n(5628),m=n(184),f=function(e){var t=e.user,n=e.photosCount,c=e.followerCount,i=e.setFollowerCount,u=e.profile,f=u.docId,h=u.userId,p=u.fullName,v=u.followers,j=u.following,w=u.username,g=u.avatarSrc,N=(0,x.Z)().user,b=(0,o.useState)(!1),Z=(0,l.Z)(b,2),y=Z[0],k=Z[1],C=N.username&&N.username!==w,S=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k((function(e){return!e})),i({followerCount:y?c-1:c+1}),e.next=4,(0,a.Gm)(y,N.docId,f,h,N.userId);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){var e=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.IU)(N.username,h);case 2:t=e.sent,k(!!t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();N.username&&h&&e()}),[N.username,h]),(0,m.jsxs)("div",{className:"grid grid-cols-3 gap-4 justify-between mx-auto max-w-screen-lg",children:[(0,m.jsx)("div",{className:"container flex justify-center",children:g?(0,m.jsx)("img",{className:"rounded-full h-40 w-40 flex",alt:"".concat(w," profilePicture"),src:g}):(0,m.jsx)(d.Z,{count:1,width:160,height:160})}),(0,m.jsxs)("div",{className:"flex items-center justify-center flex-col col-span-2",children:[(0,m.jsxs)("div",{className:"container flex items-center",children:[(0,m.jsx)("p",{className:"text-2xl mr-4 flex flex-col",children:w}),C&&(0,m.jsx)("button",{className:"bg-blue-500 font-bold text-sm rounded text-white w-20 h-8",type:"button",onClick:S,children:y?"Unfollow":"Follow"})]}),(0,m.jsx)("div",{className:"container flex mt-4",children:void 0===v||void 0===j?(0,m.jsx)(d.Z,{count:1,width:677,height:24}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("p",{className:"mr-10",children:[(0,m.jsx)("span",{className:"font-bold",children:n})," ","posts"]}),(0,m.jsxs)("p",{className:"mr-10",children:[(0,m.jsx)("span",{className:"font-bold",children:c})," ",1===c?"follower":"followers"]}),(0,m.jsxs)("p",{className:"mr-10",children:[(0,m.jsx)("span",{className:"font-bold",children:j.length})," ","following"]})]})}),(0,m.jsx)("div",{className:"container mt-4",children:(0,m.jsx)("p",{className:"font-medium flex flex-col",children:p?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:p}),(0,m.jsx)("span",{className:"font-normal text-gray-500",children:t.aboutMe})]}):(0,m.jsx)(d.Z,{height:24})})})]})]})},h=n(9499),p=n(9018),v=n(702),j=function(){return(0,m.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,m.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})})},w=n(6423),g=function(e){var t=e.comment,n=e.redirect,c=(e.setComments,(0,o.useState)({})),i=(0,l.Z)(c,2),u=i[0],d=i[1],x=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var n,r,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.dQ)(t.displayName.toLowerCase());case 2:n=e.sent,r=(0,l.Z)(n,1),o=r[0],d(o);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){x()}),[]),(0,m.jsx)("div",{className:"flex mb-4",children:(0,m.jsxs)("div",{className:"flex items-center",children:[(0,m.jsx)("div",{className:"flex-auto w-8 cursor-pointer",onClick:function(){return n(t.displayName)},children:(0,m.jsx)("div",{className:"w-8 h-8",children:u&&(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("img",{className:"w-full h-full rounded-full",src:null===u||void 0===u?void 0:u.avatarSrc,alt:""})})})}),(0,m.jsx)("div",{children:(0,m.jsxs)("p",{className:"ml-2",children:[(0,m.jsx)("span",{className:"font-bold cursor-pointer",onClick:function(){return n(t.displayName)},children:t.displayName})," ",t.comment]})})]})})},N=function(e){var t=e.photo,n=e.setShowModal,s=(0,o.useState)(t.comments),r=(0,l.Z)(s,2),a=r[0],i=r[1],u=(0,c.s0)(),d=function(e){n(!1),u("/".concat(e))};return(0,o.useEffect)((function(){i(t.comments)}),[t.comments]),(0,m.jsx)("div",{className:"flex flex-col",children:a.map((function(e,t){return(0,m.jsx)(g,{comment:e,redirect:d,setComments:i},t)}))})},b=n(3433),Z=n(4762),y=n(1303),k=n(9344),C=n(7346),S=n(1528),I=function(e){var t,n=e.post,c=e.setPost,a=(0,o.useContext)(y.Z).user,i=(0,o.useState)(n.userLikedPhoto),d=(0,l.Z)(i,2),x=d[0],f=d[1],h=(0,o.useState)(null===n||void 0===n||null===(t=n.likes)||void 0===t?void 0:t.length),p=(0,l.Z)(h,2),v=p[0],j=p[1],w=(0,o.useState)(""),g=(0,l.Z)(w,2),N=g[0],I=g[1],M=(0,o.useState)(!1),z=(0,l.Z)(M,2),F=z[0],P=z[1],L=(0,o.useContext)(k.Z),R=L.firebase,E=L.FieldValue,H=(0,o.useRef)(null),U=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f((function(e){return!e})),e.next=3,R.firestore().collection("photos").doc(n.docId).update({likes:x?E.arrayRemove(a.uid):E.arrayUnion(a.uid)});case 3:j((function(e){return x?e-1:e+1}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat((0,b.Z)(n.comments),[{comment:N,displayName:a.displayName}]),c((0,u.Z)((0,u.Z)({},n),{},{comments:t})),e.next=4,R.firestore().collection("photos").doc(n.docId).update({comments:E.arrayUnion({displayName:a.displayName,comment:N})});case 4:return e.abrupt("return",I(""));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"flex border-t",children:(0,m.jsxs)("div",{className:"flex ml-2 mt-1",children:[(0,m.jsx)("div",{children:(0,m.jsx)("svg",{onClick:U,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0,className:"w-8 mr-4 select-none cursor-pointer ".concat(x?"fill-red-500 text-red-500":"text-black"),children:(0,m.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),(0,m.jsx)("div",{children:(0,m.jsx)("svg",{onClick:function(){return H.current.focus()},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-8 text-black-light select-none cursor-pointer",children:(0,m.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 01-2.555-.337A5.972 5.972 0 015.41 20.97a5.969 5.969 0 01-.474-.065 4.48 4.48 0 00.978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25z"})})})]})}),(0,m.jsxs)("div",{className:"ml-2 my-2",children:[(0,m.jsx)("div",{className:"flex",children:(0,m.jsx)("p",{className:"font-bold",children:"".concat(v,1===v?" like":" likes")})}),(0,m.jsx)("div",{children:(0,m.jsxs)("p",{className:"text-gray-500 uppercase",style:{fontSize:"11px"},children:[(0,C.Z)(n.dateCreated,Date.now())," ago"]})})]}),(0,m.jsxs)("div",{className:"flex items-center border justify-between relative",children:[(0,m.jsx)("div",{className:"pl-1",onClick:function(){return P((function(e){return!e}))},children:(0,m.jsx)(Z.Z,{})}),F&&(0,m.jsx)("div",{className:"absolute bg-white max-h-sm border rounded",style:{bottom:"40px"},children:(0,m.jsx)("div",{className:"grid max-h-40 overflow-auto grid-cols-6 p-3",children:S.W.map((function(e){return(0,m.jsx)("div",{className:"hover:bg-slate-300 p-1 cursor-pointer",onClick:function(){return I("".concat(N).concat(e))},children:(0,m.jsx)("span",{children:e})})}))})}),(0,m.jsx)("div",{className:"w-full",children:(0,m.jsx)("input",{value:N,onChange:function(e){return I(e.target.value)},ref:H,className:"text-sm text-gray-base w-full mr-3 py-3   px-2 comment-input",placeholder:"Add comment..."})}),(0,m.jsx)("div",{children:(0,m.jsx)("button",{className:"text-[#005c98] font-bold text-sm rounded text-blue w-14 h-8",onClick:B,children:"Post"})})]})]})},M=function(e){var t=e.setShowModal,n=e.deletePost;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 outline-none focus:outline-none",style:{zIndex:60},children:(0,m.jsx)("div",{className:"relative w-auto my-6 mx-auto max-w-3xl",children:(0,m.jsx)("div",{className:"border-0 rounded-md shadow relative flex flex-col w-full bg-white outline-none focus:outline-none",children:(0,m.jsxs)("div",{className:"relative flex-auto w-72",children:[(0,m.jsx)("div",{className:"border-b flex justify-center px-2 py-2 text-red-500 font-semibold",onClick:n,children:(0,m.jsx)("button",{children:"Delete Post"})}),(0,m.jsx)("div",{className:"flex justify-center px-2 py-2",onClick:function(){return t(!1)},children:(0,m.jsx)("button",{children:"Cancel"})})]})})})}),(0,m.jsx)("div",{className:"opacity-50 z-10 fixed inset-0 bg-black",style:{zIndex:55}})]})},z=function(e){var t=e.showModal,n=e.setShowModal,c=e.photo,i=(0,o.useContext)(y.Z).user,u=(0,o.useContext)(P).getProfileInfoAndPhotos,x=(0,o.useState)(),f=(0,l.Z)(x,2),g=f[0],b=f[1],Z=(0,o.useState)({}),k=(0,l.Z)(Z,2),C=k[0],S=k[1],z=(0,o.useState)(!1),F=(0,l.Z)(z,2),L=F[0],R=F[1],E=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.Yh)(i.uid,c.photoId);case 2:t=e.sent,b(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var t,n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.userId){e.next=7;break}return e.next=3,(0,a.xD)(c.userId);case 3:t=e.sent,n=(0,l.Z)(t,1),r=n[0],S(r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var t,r,l,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a._4)(c.docId);case 2:t=v.tO.refFromURL(c.imageSrc),r=t.fullPath,l=(0,p.cF)(),o=(0,p.iH)(l,r),(0,p.oq)(o).then((function(){alert("Success")})).catch((function(e){alert(e.message)})),R(!1),n(!1),u();case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){H(),c.photoId&&E()}),[c.userId]),(0,m.jsx)(m.Fragment,{children:t?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(w.jp,{}),L&&(0,m.jsx)(M,{setShowModal:R,deletePost:U}),(0,m.jsxs)("div",{className:"justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none",children:[(0,m.jsx)("div",{onClick:function(){return n(!1)},style:{zIndex:1e4},className:"absolute top-5 right-5 cursor-pointer",children:(0,m.jsx)(h.Z,{})}),(0,m.jsx)("div",{className:"relative w-auto my-6 mx-auto max-w-3xl",children:(0,m.jsx)("div",{className:"border-0 shadow-lg relative flex flex-col w-full bg-white outline-none focus:outline-none",children:(0,m.jsxs)("div",{className:"flex",children:[(0,m.jsx)("div",{children:c.imageSrc?(0,m.jsx)("img",{src:c.imageSrc,alt:""}):(0,m.jsx)(d.Z,{count:1,height:750,width:540})}),(0,m.jsx)("div",{className:"px-4 py-2 relative",style:{width:"600px"},children:(0,m.jsxs)("div",{className:"flex flex-col",children:[(0,m.jsxs)("div",{className:"flex justify-between items-center pb-2 mt-1 border-b",children:[(0,m.jsxs)("div",{className:"flex items-center",children:[(0,m.jsx)("div",{className:"w-8 h-8",children:(0,m.jsx)("img",{className:"rounded-full cursor-pointer w-full h-full flex mr-3",src:C.avatarSrc,alt:""})}),(0,m.jsx)("div",{children:(0,m.jsx)("span",{className:"ml-4",children:C.username})})]}),(0,m.jsx)("div",{className:"ml-10",children:(0,m.jsx)("div",{className:"cursor-pointer",onClick:function(){return R(!0)},children:(0,m.jsx)(j,{})})})]}),(0,m.jsx)("div",{className:"mt-2 overflow-auto max-h-96",children:g&&(0,m.jsx)(N,{photo:g,setShowModal:n})}),(0,m.jsx)("div",{className:"w-full absolute bottom-0 left-0",children:g&&(0,m.jsx)(I,{post:g,setPost:b})})]})})]})})})]}),(0,m.jsx)("div",{className:"opacity-25 fixed inset-0 z-40 bg-black"})]}):null})},F=function(e){var t=e.photos,n=(0,o.useState)({}),s=(0,l.Z)(n,2),r=s[0],c=s[1],a=(0,o.useState)(!1),i=(0,l.Z)(a,2),u=i[0],x=i[1];return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(z,{showModal:u,setShowModal:x,photo:r}),(0,m.jsxs)("div",{className:"h-16 border-t border-gray-500 mt-12 pt-4",children:[(0,m.jsx)("div",{className:"grid grid-cols-3 gap-8 mt-4 mb-12 ",children:t?t.length>0?t.map((function(e){return(0,m.jsx)("div",{children:(0,m.jsxs)("div",{className:"relative group",onClick:function(){return c(e),void x(!0)},children:[(0,m.jsx)("img",{src:e.imageSrc,alt:e.caption}),(0,m.jsxs)("div",{className:"absolute bottom-0 left-0 bg-gray-200 w-full justify-evenly items-center h-full bg-black opacity-50 group-hover:flex hidden",children:[(0,m.jsxs)("p",{className:"flex items-center text-white font-bold",children:[(0,m.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-8 mr-4",children:(0,m.jsx)("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"})}),e.likes.length]}),(0,m.jsxs)("p",{className:"flex items-center text-white font-bold",children:[(0,m.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-8 mr-4",children:(0,m.jsx)("path",{fillRule:"evenodd",d:"M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z",clipRule:"evenodd"})}),e.comments.length]})]})]})},e.docId)})):null:(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(d.Z,{count:12,width:320,height:400})})}),!t||0===t.length&&(0,m.jsx)("p",{className:"text-center text-2xl",children:"No Posts Yet"})]})]})},P=(0,o.createContext)(),L=function(e){var t=e.user,n=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a._T)(t.username);case 2:n=e.sent,v({profile:t,photosCollection:n,followerCount:t.followers.length});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=(0,o.useReducer)((function(e,t){return(0,u.Z)((0,u.Z)({},e),t)}),{profile:{},photosCollection:[],followerCount:0}),i=(0,l.Z)(c,2),d=i[0],x=d.profile,h=d.photosCollection,p=d.followerCount,v=i[1];return(0,o.useEffect)((function(){n()}),[t]),(0,m.jsxs)(P.Provider,{value:{getProfileInfoAndPhotos:n},children:[(0,m.jsx)(f,{photosCount:h?h.length:0,profile:x,followerCount:p,setFollowerCount:v,user:t}),(0,m.jsx)(F,{photos:h})]})},R=function(){var e=(0,c.UO)().username,t=(0,o.useState)(null),n=(0,l.Z)(t,2),u=n[0],d=n[1],x=(0,c.s0)();return(0,o.useEffect)((function(){var t=function(){var t=(0,r.Z)((0,s.Z)().mark((function t(){var n,r,o;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,a.dQ)(e);case 2:n=t.sent,r=(0,l.Z)(n,1),null!==(o=r[0])&&void 0!==o&&o.userId?d(o):x(i.Hi);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[e,x]),u?(0,m.jsx)("div",{className:"bg-gray-background mt-10",children:(0,m.jsx)("div",{className:"mx-auto max-w-screen-lg",children:(0,m.jsx)(L,{user:u})})}):null}}}]);
//# sourceMappingURL=817.2fb08c84.chunk.js.map