"use strict";(self.webpackChunkinstagram_app=self.webpackChunkinstagram_app||[]).push([[196],{9196:function(e,t,n){n.r(t),n.d(t,{default:function(){return D}});var s=n(2791),r=n(6659),a=n(4165),c=n(5861),o=n(9439),l=n(6042),i=n(1303),u=function(){var e=(0,s.useState)(null),t=(0,o.Z)(e,2),n=t[0],r=t[1],u=(0,s.useContext)(i.Z).user.uid,d=void 0===u?"":u;return(0,s.useEffect)((function(){function e(){return(e=(0,c.Z)((0,a.Z)().mark((function e(){var t,n,s,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.xD)(d);case 2:if(t=e.sent,n=(0,o.Z)(t,1),s=n[0],c=[],!(s.following.length>0)){e.next=10;break}return e.next=9,(0,l.wP)(d,s.following);case 9:c=e.sent;case 10:c.sort((function(e,t){return t.dateCreated-e.dateCreated})),r(c);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[d]),{photos:n}},d=n(9344),m=n(184),x=function(e){var t=e.docId,n=e.totalLikes,r=e.likedPhoto,l=e.handleFocus,u=(0,s.useContext)(i.Z).user.uid,x=void 0===u?"":u,f=(0,s.useState)(r),p=(0,o.Z)(f,2),h=p[0],j=p[1],v=(0,s.useState)(n),g=(0,o.Z)(v,2),N=g[0],b=g[1],w=(0,s.useContext)(d.Z),y=w.firebase,I=w.FieldValue,k=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j((function(e){return!e})),e.next=3,y.firestore().collection("photos").doc(t).update({likes:h?I.arrayRemove(x):I.arrayUnion(x)});case 3:b((function(e){return h?e-1:e+1}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"flex justify-between p-4",children:(0,m.jsxs)("div",{className:"flex",children:[(0,m.jsx)("svg",{onClick:k,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0,className:"w-8 mr-4 select-none cursor-pointer ".concat(h?"fill-red-500 text-red-500":"text-black"),children:(0,m.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),(0,m.jsx)("svg",{onClick:l,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-8 text-black-light select-none cursor-pointer",children:(0,m.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 01-2.555-.337A5.972 5.972 0 015.41 20.97a5.969 5.969 0 01-.474-.065 4.48 4.48 0 00.978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25z"})})]})}),(0,m.jsx)("div",{className:"p-4 py-0",children:(0,m.jsx)("p",{className:"font-bold",children:"".concat(N,1===N?" like":" likes")})})]})},f=n(3504),p=function(e){var t=e.username,n=e.avatarSrc;return(0,m.jsx)("div",{className:"flex border-b border-gray-primary h-4 p-4 py-8",children:(0,m.jsx)("div",{className:"flex items-center",children:(0,m.jsxs)(f.rU,{to:"/".concat(t),className:"flex items-center",children:[(0,m.jsx)("img",{className:"rounded-full h-8 w-8 flex mr-3",src:n,alt:"".concat(t)}),(0,m.jsx)("p",{className:"font-bold",children:t})]})})})},h=function(e){var t=e.src,n=e.caption;return(0,m.jsx)("img",{src:t,alt:n})},j=function(e){var t=e.caption,n=e.username;return(0,m.jsxs)("div",{className:"p-4 pt-2 pb-0",children:[(0,m.jsx)("span",{className:"mr-1 font-bold",children:n}),(0,m.jsx)("span",{children:t})]})},v=n(7346),g=n(3433),N=n(1528),b=function(e){var t=e.docId,n=e.comments,r=e.setComments,a=e.commentInput,c=(0,s.useState)(""),l=(0,o.Z)(c,2),u=l[0],x=l[1],f=(0,s.useRef)(),p=(0,s.useState)(!1),h=(0,o.Z)(p,2),j=h[0],v=h[1],b=(0,s.useContext)(d.Z),w=b.firebase,y=b.FieldValue,I=(0,s.useContext)(i.Z).user.displayName;(0,s.useEffect)((function(){function e(e){f.current&&!f.current.contains(e.target)&&v(!1)}return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[f]);return(0,m.jsx)("div",{className:"border-t border-gray-primary",children:(0,m.jsxs)("form",{className:"flex justify-between pl-0 pr-5 relative",method:"POST",onSubmit:function(e){return u.length>=1?function(e){return e.preventDefault(),r([{displayName:I,comment:u}].concat((0,g.Z)(n))),x(""),w.firestore().collection("photos").doc(t).update({comments:y.arrayUnion({displayName:I,comment:u})})}(e):e.preventDefault()},children:[(0,m.jsxs)("div",{className:"flex items-center ml-3 cursor-pointer",onClick:function(){return v((function(e){return!e}))},children:[j&&(0,m.jsx)("div",{className:"absolute bg-white max-h-sm border rounded",style:{top:"50px"},ref:f,children:(0,m.jsx)("div",{className:"grid max-h-40 overflow-auto grid-cols-6 p-3",children:N.W.map((function(e){return(0,m.jsx)("div",{className:"hover:bg-slate-300 p-1 cursor-pointer",onClick:function(){return x("".concat(u).concat(e))},children:(0,m.jsx)("span",{children:e})})}))})}),(0,m.jsx)("svg",{fill:"#000",height:"25px",role:"img",viewBox:"0 0 24 24",width:"25px",children:(0,m.jsx)("path",{d:"M15.83 10.997a1.167 1.167 0 101.167 1.167 1.167 1.167 0 00-1.167-1.167zm-6.5 1.167a1.167 1.167 0 10-1.166 1.167 1.167 1.167 0 001.166-1.167zm5.163 3.24a3.406 3.406 0 01-4.982.007 1 1 0 10-1.557 1.256 5.397 5.397 0 008.09 0 1 1 0 00-1.55-1.263zM12 .503a11.5 11.5 0 1011.5 11.5A11.513 11.513 0 0012 .503zm0 21a9.5 9.5 0 119.5-9.5 9.51 9.51 0 01-9.5 9.5z"})})]}),(0,m.jsx)("input",{"aria-label":"Add a comment",autoComplete:"off",className:"text-sm text-gray-base w-full mr-3 py-5 px-4",type:"text",name:"AddComment",placeholder:"Add a comment...",value:u,onChange:function(e){return x(e.target.value)},ref:a}),(0,m.jsx)("button",{type:"submit",className:"text-sm font-bold text-blue-500",children:"Post"})]})})},w=function(e){var t=e.docId,n=e.comments,r=e.posted,a=e.commentInput,c=(0,s.useState)(n),l=(0,o.Z)(c,2),i=l[0],u=l[1];return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"p-4 pt-1 pb-4",children:[i.length>=3&&(0,m.jsxs)("p",{className:"text-sm text-gray-base mb-1 cursor-pointer",children:["View all ",i.length," comments"]}),i.slice(0,3).map((function(e){return(0,m.jsxs)("p",{className:"mb-1",children:[(0,m.jsx)(f.rU,{to:"/".concat(e.displayName),children:(0,m.jsx)("span",{className:"mr-1 font-bold",children:e.displayName})}),(0,m.jsx)("span",{children:e.comment})]},"".concat(e.comment,"-").concat(e.displayName))})),(0,m.jsxs)("p",{className:"text-gray-base uppercase text-xs mt-2",children:[(0,v.Z)(r,Date.now())," ago"]})]}),(0,m.jsx)(b,{docId:t,comments:i,setComments:u,commentInput:a})]})},y=function(e){var t=e.content,n=(0,s.useRef)(null);return(0,m.jsxs)("div",{className:"rounded col-span-4 border bg-white border-gray-primary mb-16",children:[(0,m.jsx)(p,{username:t.username,avatarSrc:t.avatarSrc}),(0,m.jsx)(h,{src:t.imageSrc,caption:t.caption}),(0,m.jsx)(x,{docId:t.docId,totalLikes:t.likes.length,likedPhoto:t.userLikedPhoto,handleFocus:function(){return n.current.focus()}}),(0,m.jsx)(j,{caption:t.caption,username:t.username}),(0,m.jsx)(w,{docId:t.docId,comments:t.comments,posted:t.dateCreated,commentInput:n})]})},I=function(){var e=u().photos;return(0,m.jsx)("div",{className:"container col-span-2",children:e?(null===e||void 0===e?void 0:e.length)>0?e.map((function(e){return(0,m.jsx)(y,{content:e},e.docId)})):(0,m.jsx)("p",{className:"text-center text-2xl",children:"No Followers!"}):(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(r.Z,{count:1,width:640,height:400,className:"mb-5"})})})},k=n(5628),Z=function(e){var t=e.profileDocId,n=e.username,r=e.profileId,i=e.userId,u=e.loggedInUserDocId,d=e.profileImage,x=(0,s.useState)(!1),p=(0,o.Z)(x,2),h=p[0],j=p[1],v=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.next=3,(0,l.NS)(u,r,!1);case 3:return e.next=5,(0,l.T6)(t,i,!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return h?null:(0,m.jsxs)("div",{className:"flex flex-row items-center align-items justify-between",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)("div",{className:"w-8 h-8",children:(0,m.jsx)("img",{className:"rounded-full w-full h-full",src:d,alt:""})}),(0,m.jsx)(f.rU,{className:"ml-2",to:"/".concat(n),children:(0,m.jsx)("p",{className:"font-bold text-sm",children:n})})]}),(0,m.jsx)("div",{children:(0,m.jsx)("button",{className:"text-xs font-bold text-blue-medium text-blue-500",type:"button",onClick:v,children:"Follow"})})]})},C=function(e){var t=e.userId,n=e.following,i=e.loggedInUserDocId,u=(0,s.useState)(null),d=(0,o.Z)(u,2),x=d[0],f=d[1];return(0,s.useEffect)((function(){function e(){return(e=(0,c.Z)((0,a.Z)().mark((function e(){var s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.ve)(t,n);case 2:s=e.sent,f(s);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t&&function(){e.apply(this,arguments)}()}),[t]),x?x.length?(0,m.jsxs)("div",{className:"rounded flex flex-col",children:[(0,m.jsx)("div",{className:"text-sm flex items-center align-items justify-between mb-2",children:(0,m.jsx)("p",{className:"font-bold text-gray-base"})}),(0,m.jsx)("div",{className:"mt-4 grid gap-5",children:x.map((function(e){return(0,m.jsx)(Z,{profileImage:e.avatarSrc,profileDocId:e.docId,username:e.username,profileId:e.userId,userId:t,loggedInUserDocId:i},e.docId)}))})]}):null:(0,m.jsx)(r.Z,{count:1,height:150})},S=function(e){var t=e.username,n=e.fullName,s=e.avatarSrc;return t&&n?(0,m.jsxs)(f.rU,{to:"/".concat(t),className:"grid grid-cols-4 gap-4 mb-6 items-center",children:[(0,m.jsx)("div",{className:"flex items-center justify-between col-span-1 w-16 h-16",children:(0,m.jsx)("img",{className:"rounded-full w-full h-full",src:s,alt:"",onError:function(e){e.target.src="/images/avatars/default/.jpg"}})}),(0,m.jsxs)("div",{className:"col-span-3",children:[(0,m.jsx)("p",{className:"font-bold text-sm",children:t}),(0,m.jsx)("p",{className:"text-sm",children:n})]})]}):(0,m.jsx)(r.Z,{count:1,height:61})},L=(0,s.memo)(S),z=function(){var e=(0,k.Z)().user,t=e.docId,n=e.fullName,s=e.username,r=e.userId,a=e.following,c=e.avatarSrc;return(0,m.jsxs)("div",{className:"p-4",children:[(0,m.jsx)(L,{username:s,fullName:n,avatarSrc:c}),(0,m.jsx)(C,{userId:r,following:a,loggedInUserDocId:t})]})},D=function(){return(0,m.jsx)("div",{className:"bg-gray-background mt-10",children:(0,m.jsxs)("div",{className:"grid grid-cols-3 gap-4 justify-between mx-auto max-w-screen-lg",children:[(0,m.jsx)(I,{}),(0,m.jsx)(z,{})]})})}}}]);
//# sourceMappingURL=196.aeb3aa54.chunk.js.map